!function(e,t,s){"use strict";function l(t,s){this.element=t,this.settings=e.extend({},i,s),this._defaults=i,this._name=a,this.mouseTimeoutID=null,this.focusTimeoutID=null,this.mouseFocused=!1,this.justFocused=!1,this.init()}function o(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function r(t,s){var a,i,n,l=t.nodeName.toLowerCase();return"area"===l?(a=t.parentNode,i=a.name,t.href&&i&&"map"===a.nodeName.toLowerCase()?(n=e("img[usemap=#"+i+"]")[0],!!n&&o(n)):!1):(/input|select|textarea|button|object/.test(l)?!t.disabled:"a"===l?t.href||s:s)&&o(t)}var a="accessibleMegaMenu",i={uuidPrefix:"menu",menuClass:"menu",topNavItemClass:"menu-top-nav-item",panelClass:"menu-panel",panelGroupClass:"menu-panel-group",hoverClass:"hover",focusClass:"focus",openClass:"open"},n={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38,keyMap:{48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",190:"."}};l.prototype=function(){var f,c,d,h,p,b,g,m,C,v,x,y,T,i=0,o=1e3,r="",u="function"==typeof t.hasOwnProperty&&!!t.hasOwnProperty("ontouchstart");return f=function(t){return e(t).closest(":data(plugin_"+a+")").data("plugin_"+a)},c=function(t){t=e(t);var s=this.settings;t.attr("id")||t.attr("id",s.uuidPrefix+"-"+(new Date).getTime()+"-"+ ++i)},d=function(t,a){var c,i=e(t.target),l=this,o=this.settings,r=this.menu,u=i.closest("."+o.topNavItemClass),f=i.hasClass(o.panelClass)?i:i.closest("."+o.panelClass);if(T.call(this,!0),a)if(u=r.find("."+o.topNavItemClass+" ."+o.openClass+":first").closest("."+o.topNavItemClass),u.is(t.relatedTarget)||u.has(t.relatedTarget).length>0)0===u.length&&r.find("[aria-expanded=true]").attr("aria-expanded","false").removeClass(o.openClass).filter("."+o.panelClass).attr("aria-hidden","true");else{if(("mouseout"===t.type||"focusout"===t.type)&&u.has(s.activeElement).length>0)return;u.find("[aria-expanded]").attr("aria-expanded","false").removeClass(o.openClass).filter("."+o.panelClass).attr("aria-hidden","true"),("keydown"===t.type&&t.keyCode===n.ESCAPE||"DOMAttrModified"===t.type)&&(c=u.find(":tabbable:first"),setTimeout(function(){r.find("[aria-expanded]."+l.settings.panelClass).off("DOMAttrModified.menu"),c.focus(),l.justFocused=!1},99))}else clearTimeout(l.focusTimeoutID),u.siblings().find("[aria-expanded]").attr("aria-expanded","false").removeClass(o.openClass).filter("."+o.panelClass).attr("aria-hidden","true"),u.find("[aria-expanded]").attr("aria-expanded","true").addClass(o.openClass).filter("."+o.panelClass).attr("aria-hidden","false"),"mouseover"===t.type&&i.is(":tabbable")&&1===u.length&&0===f.length&&r.has(s.activeElement).length>0&&(i.focus(),l.justFocused=!1),T.call(l)},h=function(t){var s=e(t.currentTarget),a=s.closest("."+this.settings.topNavItemClass),i=s.closest("."+this.settings.panelClass);1===a.length&&0===i.length&&1===a.find("."+this.settings.panelClass).length&&(s.hasClass(this.settings.openClass)?this.justFocused?(t.preventDefault(),t.stopPropagation(),this.justFocused=!1):u&&(t.preventDefault(),t.stopPropagation(),d.call(this,t,s.hasClass(this.settings.openClass))):(t.preventDefault(),t.stopPropagation(),d.call(this,t),this.justFocused=!1))},p=function(t){0===e(t.target).closest(this.menu).length&&(t.preventDefault(),t.stopPropagation(),d.call(this,t,!0))},b=function(t){"aria-expanded"===t.originalEvent.attrName&&"false"===t.originalEvent.newValue&&e(t.target).hasClass(this.settings.openClass)&&(t.preventDefault(),t.stopPropagation(),d.call(this,t,!0))},g=function(t){clearTimeout(this.focusTimeoutID);var s=e(t.target),a=s.closest("."+this.settings.panelClass);s.addClass(this.settings.focusClass).on("click.menu",e.proxy(h,this)),this.justFocused=!this.mouseFocused,this.mouseFocused=!1,this.panels.not(a).filter("."+this.settings.openClass).length&&d.call(this,t)},m=function(s){this.justFocused=!1;var a=this,i=e(s.target),n=i.closest("."+this.settings.topNavItemClass);i.removeClass(this.settings.focusClass).off("click.menu"),t.cvox?a.focusTimeoutID=setTimeout(function(){t.cvox.Api.getCurrentNode(function(e){n.has(e).length?clearTimeout(a.focusTimeoutID):a.focusTimeoutID=setTimeout(function(e,t,s){d.call(e,t,s)},275,a,s,!0)})},25):a.focusTimeoutID=setTimeout(function(){d.call(a,s,!0)},300)},C=function(s){var x,T,D,E,k,P,a=this.constructor===l?this:f(this),i=a.settings,u=e(e(this).is("."+i.hoverClass+":tabbable")?this:s.target),c=a.menu,p=a.topnavitems,b=u.closest("."+i.topNavItemClass),g=c.find(":tabbable"),m=u.hasClass(i.panelClass)?u:u.closest("."+i.panelClass),C=m.find("."+i.panelGroupClass),v=u.closest("."+i.panelGroupClass),y=s.keyCode||s.which,I=!1,N=n.keyMap[s.keyCode]||"",w=1===b.length&&0===m.length;if(!u.is("input:focus, select:focus, textarea:focus, button:focus")){switch(u.is("."+i.hoverClass+":tabbable")&&e("html").off("keydown.menu"),y){case n.ESCAPE:d.call(a,s,!0);break;case n.DOWN:s.preventDefault(),w?(d.call(a,s),I=1===b.find("."+i.panelClass+" :tabbable:first").focus().length):I=1===g.filter(":gt("+g.index(u)+"):first").focus().length,!I&&t.opera&&"[object Opera]"===opera.toString()&&(s.ctrlKey||s.metaKey)&&(g=e(":tabbable"),D=g.index(u),I=1===e(":tabbable:gt("+e(":tabbable").index(u)+"):first").focus().length);break;case n.UP:s.preventDefault(),w&&u.hasClass(i.openClass)?(d.call(a,s,!0),x=p.filter(":lt("+p.index(b)+"):last"),x.children("."+i.panelClass).length&&(I=1===x.children().attr("aria-expanded","true").addClass(i.openClass).filter("."+i.panelClass).attr("aria-hidden","false").find(":tabbable:last").focus())):w||(I=1===g.filter(":lt("+g.index(u)+"):last").focus().length),!I&&t.opera&&"[object Opera]"===opera.toString()&&(s.ctrlKey||s.metaKey)&&(g=e(":tabbable"),D=g.index(u),I=1===e(":tabbable:lt("+e(":tabbable").index(u)+"):first").focus().length);break;case n.RIGHT:s.preventDefault(),w?I=1===p.filter(":gt("+p.index(b)+"):first").find(":tabbable:first").focus().length:(C.length&&v.length&&(I=1===C.filter(":gt("+C.index(v)+"):first").find(":tabbable:first").focus().length),I||(I=1===b.find(":tabbable:first").focus().length));break;case n.LEFT:s.preventDefault(),w?I=1===p.filter(":lt("+p.index(b)+"):last").find(":tabbable:first").focus().length:(C.length&&v.length&&(I=1===C.filter(":lt("+C.index(v)+"):last").find(":tabbable:first").focus().length),I||(I=1===b.find(":tabbable:first").focus().length));break;case n.TAB:D=g.index(u),s.shiftKey&&w&&u.hasClass(i.openClass)?(d.call(a,s,!0),x=p.filter(":lt("+p.index(b)+"):last"),x.children("."+i.panelClass).length&&(I=x.children().attr("aria-expanded","true").addClass(i.openClass).filter("."+i.panelClass).attr("aria-hidden","false").find(":tabbable:last").focus())):s.shiftKey&&D>0?I=1===g.filter(":lt("+D+"):last").focus().length:!s.shiftKey&&D<g.length-1?I=1===g.filter(":gt("+D+"):first").focus().length:t.opera&&"[object Opera]"===opera.toString()&&(g=e(":tabbable"),D=g.index(u),I=s.shiftKey?1===e(":tabbable:lt("+e(":tabbable").index(u)+"):last").focus().length:1===e(":tabbable:gt("+e(":tabbable").index(u)+"):first").focus().length),I&&s.preventDefault();break;case n.SPACE:if(!w)return!0;s.preventDefault(),h.call(a,s);break;case n.ENTER:return!0;default:if(clearTimeout(this.keydownTimeoutID),r+=N!==r?N:"",0===r.length)return;for(this.keydownTimeoutID=setTimeout(function(){r=""},o),g=w&&!u.hasClass(i.openClass)?g.filter(":not(."+i.panelClass+" :tabbable)"):b.find(":tabbable"),s.shiftKey&&(g=e(g.get().reverse())),D=0;D<g.length;D++)if(E=g.eq(D),E.is(u)){T=1===r.length?D+1:D;break}for(P=new RegExp("^"+r.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),"i"),D=T;D<g.length;D++)if(E=g.eq(D),k=e.trim(E.text()),P.test(k)){I=!0,E.focus();break}if(!I)for(D=0;T>D;D++)if(E=g.eq(D),k=e.trim(E.text()),P.test(k)){E.focus();break}}a.justFocused=!1}},v=function(t){(e(t.target).is(this.settings.panelClass)||e(t.target).closest(":focusable").length)&&(this.mouseFocused=!0),this.mouseTimeoutID=setTimeout(function(){clearTimeout(this.focusTimeoutID)},1)},x=function(t){clearTimeout(this.mouseTimeoutID),e(t.target).addClass(this.settings.hoverClass),d.call(this,t),e(t.target).is(":tabbable")&&e("html").on("keydown.menu",e.proxy(C,t.target))},y=function(t){var s=this;e(t.target).removeClass(s.settings.hoverClass),s.mouseTimeoutID=setTimeout(function(){d.call(s,t,!0)},250),e(t.target).is(":tabbable")&&e("html").off("keydown.menu")},T=function(t){var s=this.menu;t?(e("html").off("mouseup.outside-menu, touchend.outside-menu, mspointerup.outside-menu,  pointerup.outside-menu"),s.find("[aria-expanded]."+this.settings.panelClass).off("DOMAttrModified.menu")):(e("html").on("mouseup.outside-menu, touchend.outside-menu, mspointerup.outside-menu,  pointerup.outside-menu",e.proxy(p,this)),s.find("[aria-expanded=true]."+this.settings.panelClass).on("DOMAttrModified.menu",e.proxy(b,this)))},{constructor:l,init:function(){var t=this.settings,s=e(this.element),a=s.children().first(),i=a.children();this.start(t,s,a,i)},start:function(t,a,i,n){var l=this;this.settings=t,this.menu=i,this.topnavitems=n,a.attr("role","navigation"),i.addClass(t.menuClass),n.each(function(s,a){var i,n;a=e(a),a.addClass(t.topNavItemClass),i=a.find(":tabbable:first"),n=a.children(":not(:tabbable):last"),c.call(l,i),n.length&&(c.call(l,n),i.attr({"aria-haspopup":!0,"aria-controls":n.attr("id"),"aria-expanded":!1}),n.attr({role:"group","aria-expanded":!1,"aria-hidden":!0}).addClass(t.panelClass).not("[aria-labelledby]").attr("aria-labelledby",i.attr("id")))}),this.panels=i.find("."+t.panelClass),i.on("focusin.menu",":focusable, ."+t.panelClass,e.proxy(g,this)).on("focusout.menu",":focusable, ."+t.panelClass,e.proxy(m,this)).on("keydown.menu",e.proxy(C,this)).on("mouseover.menu",e.proxy(x,this)).on("mouseout.menu",e.proxy(y,this)).on("mousedown.menu",e.proxy(v,this)),u&&i.on("touchstart.menu",e.proxy(h,this)),i.find("hr").attr("role","separator"),e(s.activeElement).closest(i).length&&e(s.activeElement).trigger("focusin.menu")},getDefaults:function(){return this._defaults},getOption:function(e){return this.settings[e]},getAllOptions:function(){return this.settings},setOption:function(e,t,s){this.settings[e]=t,s&&this.init()}}}(),e.fn[a]=function(t){return this.each(function(){e.data(this,"plugin_"+a)||e.data(this,"plugin_"+a,new e.fn[a].AccessibleMegaMenu(this,t))})},e.fn[a].AccessibleMegaMenu=l,e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(s){return!!e.data(s,t)}}):function(t,s,a){return!!e.data(t,a[3])},focusable:function(t){return r(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var s=e.attr(t,"tabindex"),a=isNaN(s);return(a||s>=0)&&r(t,!a)}})}(jQuery,window,document);